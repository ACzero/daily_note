## 2017/02

### request对象*

grape中使用request.body.string，本地没问题，staging服务器使用passenger报错，request.body对象在不同服务器下不同

### ransack

search_field中包含integer_column: https://github.com/activerecord-hackery/ransack/issues/85

### sidekiq

sidekiq并发与数据库总连接数

http://stackoverflow.com/questions/25968728/sidekiq-could-not-obtain-a-database-connection-within-5-000-seconds

https://github.com/mperham/sidekiq/wiki/Advanced-Options#concurrency

### Rails constant load

namespace与class同名时，class的const_missing会返回已定义的对象。

```
warning: toplevel constant ApplicationController referenced by SuperAdmin::ApplicationController
```

参考
http://stackoverflow.com/questions/3175591/rails3-warning-toplevel-constant-applicationcontroller-referenced-by

http://stackoverflow.com/questions/10902023/rails-3-2-3-namespaced-controllers-being-overridden-by-global-controllers-with-s/10902980#10902980

https://groups.google.com/forum/#!topic/rubyonrails-core/urXofuENLss

### ActiveRecord code style

Placing your callbacks after associations is usually a good practice.

http://api.rubyonrails.org/classes/ActiveRecord/AutosaveAssociation.html

has_many :through

https://github.com/rails/rails/issues/8828

## 2017/03/28

### inverse_of

总结

1. `inverse_of`用于在`has_many`,`has_one`,`belongs_to`中自动引用关联对象，即已实例化关联对象，在某些情况下使用关联对象不会再去查找数据库，而是直接使用已实例化的对象。主要用于减少查询。
2. 使用`has_many through`情况下，若不设置`inverse_of`，会出现中间表对象没有引用关联对象的情况，有可能导致中间表记录不创建的情况。
3. 在`rails4.2`下，`has_many through`为中间表添加`inverse_of`发现行为比较奇怪，要根据源码分析，猜测不出实现。

由于`rails4.1+`会自动添加`inverse_of`，上述1,2点仅在小于4.1版本出现，不过对于某些情况是不会自动添加`inverse_of`的。关于`inverse_of`的限制(不支持某些设置或关联类型)，参考[官方文档](http://guides.rubyonrails.org/association_basics.html#bi-directional-associations)

参考

https://ruby-china.org/topics/24998
https://www.viget.com/articles/exploring-the-inverse-of-option-on-rails-model-associations

## 2017/03/29

### Rspec中添加helper方法

http://www.rubydoc.info/github/rspec/rspec-core/RSpec/Core/Configuration#include-instance_method

http://stackoverflow.com/questions/20955384/how-to-reuse-a-context-in-rspec

注意点

* 在配置`rails_helper.rb`中`include`可以通过`type`选项指定类型加载。
* 要首先加载文件，如定义在`spec/support`下则需要对该目录下文件进行`require`

### Rspec中的复用

复用测试用例，使用`shared examples`
https://www.relishapp.com/rspec/rspec-core/v/3-5/docs/example-groups/shared-examples

复用方法或数据定义等(非完整测试)，使用`shared context`
https://www.relishapp.com/rspec/rspec-core/docs/example-groups/shared-context

## 2017/03/30

### Rails中的ActiveRecord存在性检查优化

只用于检查DB中对象是否存在时，通常使用`exist?`会有最佳性能

```ruby
User.exist?
```

https://semaphoreci.com/blog/2017/03/14/faster-rails-how-to-check-if-a-record-exists.html

## 2017/04/01

### 杂谈

闲逛看到的[The Twelve-Factor App](https://12factor.net/)

构建saas应用的注意要点，感觉基本适用于大部分应用。
可理解为如何提高项目的可维护性

## 2017/04/10

### web服务器与web应用的模型

[Phusion Passenger Design and Architecture](https://www.phusionpassenger.com/documentation/Design%20and%20Architecture.html)

(总结待补充..)

## 2017/04/11

### 深入ActiveRecord

[20,000 Leagues Under ActiveRecord]http://patshaughnessy.net/2014/9/17/20000-leagues-under-activerecord

(总结待补充..)

## 2017/04/14

### 从零开始理解为什么js需要打包..

首先理解js的执行环境

[Javascript诞生记](http://www.ruanyifeng.com/blog/2011/06/birth_of_javascript.html)
[JavaScript 运行机制详解：再谈Event Loop](http://www.ruanyifeng.com/blog/2014/10/event-loop.html)
[Javascript在网页页面加载时的执行顺序](http://blog.csdn.net/kylinbl/article/details/6160587)

大概就是开发者遇到了js无法模块化导致命名空间混乱，影响加载速度等各种问题....

于是出现了各种打包工具

http://www.ruanyifeng.com/blog/2014/09/package-management.html

打包工具基本是基于这几个种[规范](http://blog.csdn.net/baihuaxiu123/article/details/58605918)的实现
